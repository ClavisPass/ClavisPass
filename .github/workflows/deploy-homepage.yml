name: Deploy Homepage and Keep updater.json on gh-pages

on:
  push:
    branches:
      - master  # Oder 'master', je nachdem, welchen Branch du verwendest

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Install Git
        run: sudo apt-get install git

      - name: Clone gh-pages branch
        run: |
          git clone --branch gh-pages https://x-access-token:${{ secrets.GITHUB_TOKEN }}@github.com/${{ github.repository }} gh-pages
          cd gh-pages
          git config --global user.name "github-actions"
          git config --global user.email "actions@github.com"

      - name: Copy homepage files and updater.json to gh-pages
        run: |
          # Stelle sicher, dass der 'homepage' Ordner im Root des Repositories existiert
          cp -r ../homepage/* ./  # Kopiere alle Dateien aus dem 'homepage' Ordner im Root in den gh-pages Branch
          cp ../updater.json ./  # Stelle sicher, dass die updater.json Datei ebenfalls mitkopiert wird

      - name: Commit and push changes
        run: |
          git add .
          git commit -m "Deploy new homepage content and update updater.json" || echo "No changes to commit"
          git push origin gh-pages